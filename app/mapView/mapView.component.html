<!-- Header -->
<header id="header">
    <button (click)="this._router.navigateByUrl('/mapView')" class="button ref" type="submit">Eventail/Map View</button>
    <button (click)="this._router.navigateByUrl('/friends')" class="button ref" type="submit">Friends</button>
</header>

<!-- Banner -->
<section id="banner">
  <div class="posts">
    <article>
      <!-- this creates a google map on the page with the given lat/lng from -->
      <!-- the component as the initial center of the map: -->
      <sebm-google-map 
        [latitude]="lat"
        [longitude]="lng"
        [zoom]="zoom"
        [disableDefaultUI]="false"
        (mapClick)="mapClicked($event)">
        <!-- Persons -->
        <sebm-google-map-marker 
            *ngFor="let m of markerPerson; let i = index"
            (markerClick)="clickedMarker(m.label, i)"
            [latitude]="m.lat"
            [longitude]="m.lng"
            [label]="m.label"
            [markerDraggable]="m.draggable"
            (dragEnd)="markerDragEnd(m, $event)">
            
          <sebm-google-map-info-window>
            <strong>{{ m.label }}</strong>
          </sebm-google-map-info-window>
        </sebm-google-map-marker>

        <!-- Points of interest -->
        <sebm-google-map-marker
            *ngFor="let m of markerPOI; let i = index"
            (markerClick)="clickedMarkerPOI(m.title, i)"
            [latitude]="m.location[0]"
            [longitude]="m.location[1]"
            [label]="'I'"
            [title]="m.title"
            [markerDraggable]="m.draggable"
            (dragEnd)="POIMarkerDragEnd(m, $event)">
            
          <sebm-google-map-info-window>
            <strong>{{ m.title }}</strong>
          </sebm-google-map-info-window>
        </sebm-google-map-marker>
        
        <!-- Events -->
        <sebm-google-map-marker
            *ngFor="let m of markerEvent; let i = index"
            (markerClick)="clickedMarkerEvent(m.title, i)"
            [latitude]="m.location[0]"
            [longitude]="m.location[1]"
            [label]="'E'"
            [title]="m.title"
            [markerDraggable]="m.draggable"
            (dragEnd)="eventMarkerDragEnd(m, $event)">
            
          <sebm-google-map-info-window>
            <strong>{{ m.title }}</strong>
          </sebm-google-map-info-window>

          <sebm-google-map-circle [latitude]="m.location[0]" [longitude]="m.location[1]" 
            [radius]="m.radius"
            [fillColor]="'red'"
            [circleDraggable]="false"
            [editable]="false">
          </sebm-google-map-circle>
        </sebm-google-map-marker>
      </sebm-google-map>
    </article>
    <article *ngIf="this.markerEvent.length > 0 && !this.editingPointsOfInterest">
     <strong> {{ this.commandMakerEvent.title }}</strong> <br>
               lat: {{ this.commandMakerEvent.location[0] }} <br>
               lng: {{ this.commandMakerEvent.location[1] }} <br>
               radius: <input #number type='number' [(ngModel)]='this.commandMakerEvent.radius' required>  <br><br>
               Event Name <input #textbox type='text' [(ngModel)]='this.commandMakerEvent.title' required>
               Event Desc <input #textbox type='text' [(ngModel)]='this.commandMakerEvent.desc' required>
               This event begins: <input #textbox type='date' [(ngModel)]='this.commandMakerEvent.begin' required> 
               <input #time type='time' [(ngModel)]='this.hbegin' required><br>
               This event ends:   <input #textbox type='date' [(ngModel)]='this.commandMakerEvent.end' required> 
               <input #time type='time' [(ngModel)]='this.hend' required><br>
               Spontaneous <input #textbox type='checkbox' [(ngModel)]='this.commandMakerEvent.spontaneous' required> <br> 
      <button *ngIf="this.commandMakerEvent.id == undefined || this._auth.getUserId() == this.commandMakerEvent.owner"
       (click)="saveEvent(this.commandMakerEvent)" type="submit" class="button big">SAVE</button>
      <button *ngIf="this.commandMakerEvent.id == undefined || this._auth.getUserId() == this.commandMakerEvent.owner"
       (click)="deleteMarkerEvent(this.commandMakerEvent)" type="submit" class="button danger">DELETE</button>
      <button 
       (click)="this.editingPointsOfInterest = true" type="submit" class="button big">SWITCH TO POINTS OF INTEREST</button>
    </article>

    <article *ngIf="this.markerEvent.length > 0 && this.editingPointsOfInterest && this.markerPOI.length > 0">
     <strong> {{ this.commandMakerPOI.title }}</strong> <br>
               Event Name <input #textbox type='text' [(ngModel)]='this.commandMakerPOI.title' required>
               Event Desc <input #textbox type='text' [(ngModel)]='this.commandMakerPOI.desc' required> 
      <button 
       (click)="savePOI(this.commandMakerPOI)" type="submit" class="button big">SAVE</button>
      <button
       (click)="deleteMarkerPOI(this.commandMakerPOI)" type="submit" class="button danger">DELETE</button>
      <button 
       (click)="this.editingPointsOfInterest = false" type="submit" class="button big">SWITCH TO EVENTS</button>
    </article>

    <article *ngIf="this.markerEvent.length > 0 && this.editingPointsOfInterest && this.markerPOI.length == 0">
      <strong> Click anywere on the map to add a new POI.</strong> <br>
    </article>

    <article *ngIf="this.markerEvent.length == 0">
     <strong> Click anywere on the map to start a new event.</strong> <br>
    </article>
  </div>
</section>